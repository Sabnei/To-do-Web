<h1>📋 Lista de Tareas</h1>

<form method="get" action="{% url 'lista_tareas' %}">
    <label>Prioridad:</label>
    <select name="prioridad">
        <option value="">-- Todas --</option>
        <option value="alta" {% if prioridad_seleccionada == 'alta' %}selected{% endif %}>Alta</option>
        <option value="media" {% if prioridad_seleccionada == 'media' %}selected{% endif %}>Media</option>
        <option value="baja" {% if prioridad_seleccionada == 'baja' %}selected{% endif %}>Baja</option>
    </select>

    <label>Etiqueta:</label>
    <input type="text" name="etiqueta" value="{{ etiqueta }}">

    <label>Estado:</label>
    <select name="completado">
        <option value="">-- Todos --</option>
        <option value="completado" {% if estado_seleccionado == 'completado' %}selected{% endif %}>Completado</option>
        <option value="pendiente" {% if estado_seleccionado == 'pendiente' %}selected{% endif %}>Pendiente</option>
    </select>

    <button type="submit">Filtrar</button>
    <a href="{% url 'lista_tareas' %}">Reiniciar</a>
</form>

<form method="get" action="{% url 'exportar_pdf' %}">
    {% if prioridad_seleccionada %}
        <input type="hidden" name="prioridad" value="{{ prioridad_seleccionada }}">
    {% endif %}
    {% if etiqueta %}
        <input type="hidden" name="etiqueta" value="{{ etiqueta }}">
    {% endif %}
    <button type="submit">📄 Exportar PDF</button>
</form>

<hr>
<a href="{% url 'agregar_tarea' %}">➕ Agregar nueva tarea</a>
<ul>
    {% for tarea in tareas %}
    <li>
        {% if tarea.completado %}<s>{% endif %}
        {{ tarea.descripcion }} - {{ tarea.prioridad }}
        {% if tarea.completado %}</s>{% endif %}
        {% if not tarea.completado %}
            <a href="{% url 'completar_tarea' tarea.id %}">✅ Completar</a>
        {% endif %}
        <a href="{% url 'eliminar_tarea' tarea.id %}">❌ Eliminar</a>
    </li>
    {% empty %}
    <li>No hay tareas que coincidan con el filtro.</li>
    {% endfor %}
</ul>
